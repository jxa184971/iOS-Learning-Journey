# 获取网络状态及网络类型

### 判断网络是否连接 
```objective-c
- (BOOL) connectedToNetwork
{
    // 创建零地址，0.0.0.0地址表示查询本机的网络连接状态
    struct sockaddr_in zeroAddress;
    bzero(&zeroAddress, sizeof(zeroAddress));
    zeroAddress.sin_len = sizeof(zeroAddress);
    zeroAddress.sin_family = AF_INET;

    // 创建一个SCNetworkReachabilityRef对象
    SCNetworkReachabilityRef defaultRouteReachability = SCNetworkReachabilityCreateWithAddress(NULL, (struct sockaddr *)&zeroAddress);
    // 声明flag
    SCNetworkReachabilityFlags flags;

    // Get connect flags 方法返回BOOL用来判断是否有flag返回 传入&flag的引用可以获取返回的flag
    BOOL didRetrieveFlags = SCNetworkReachabilityGetFlags(defaultRouteReachability, &flags);
    //释放reachability
    CFRelease(defaultRouteReachability);
    
    // 如果不能获取连接标志，则表示没有连接网络，直接返回
    if (!didRetrieveFlags)
    {
        return NO;
    }
    
    // 根据获得的连接标志进行判断 
    // kSCNetworkFlagsReachable - 是否有网络
    // kSCNetworkFlagsConnectionRequired - 网络是否需要连接
    BOOL isReachable = flags & kSCNetworkFlagsReachable;
    BOOL needsConnection = flags & kSCNetworkFlagsConnectionRequired;
    
    return (isReachable && !needsConnection) ? YES : NO;
}
```

### 判断是否连接WIFI
```objective-c
+ (BOOL) IsEnableWIFI {
    return ([[Reachability reachabilityForLocalWiFi] currentReachabilityStatus] != NotReachable);
}
```

### 判断流量数据网络属于2G、3G还是4G
```objective-c
+ (TPNetworkEnvironment)getNetworkEnvironment {
    // 获取手机网络类型
    CTTelephonyNetworkInfo *info = [[CTTelephonyNetworkInfo alloc] init];
    NSString *currentStatus = info.currentRadioAccessTechnology;
    NSUInteger networkEnvironment;

    if ([Remote IsEnableWIFI]){
        return TPNetworkEnvironmentWIFI;
    }

    if (!currentStatus) {
        networkEnvironment = TPNetworkEnvironmentNoNetwork;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyGPRS"]) { //GPRS
        networkEnvironment = TPNetworkEnvironment2G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyEdge"]) { //Edge
        networkEnvironment = TPNetworkEnvironment2G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyWCDMA"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyHSDPA"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyHSUPA"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyCDMA1x"]){ //2G
        networkEnvironment = TPNetworkEnvironment2G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyCDMAEVDORev0"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyCDMAEVDORevA"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyCDMAEVDORevB"]){ //3G
        networkEnvironment = TPNetworkEnvironment3G;
    }else if ([currentStatus isEqualToString:@"CTRadioAccessTechnologyLTE"]){ //4G
        networkEnvironment = TPNetworkEnvironment4G;
    }else {
        networkEnvironment = TPNetworkEnvironmentUndefine;
    }
    return networkEnvironment;
}
```
